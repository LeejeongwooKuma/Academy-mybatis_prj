<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="day1226">

<sql id="empCommon">
 	select	ename, sal, comm, hiredate
 	from	emp
</sql>

<!-- 여러 조건에 의한 여러 컬럼이 조회.
	-부서번호와 사원 번호를 입력(parameterType="DTO)받아서, 사원명, 연봉, 보너스, 입사일을(resultType="DTO") 검색.
	
	- naming 팁. DTO가 2개이면 뭐가 입력받고, 뭐가 조회하는 DTO인지 알기 어렵다. 이럴 때 팁.
	ADTO -입력값 ->wehre절
	BDTO -whghlrkqt -> 조회 컬럼	 
 -->
 <select id="useDomain" parameterType="empDTO" resultType="empDomain"> <!-- 2개의 Type 값은 원래 day1226.EmpDTO, day1226.empDo..인데 config에서 alias 해둠 -->
 	<include refid="empCommon"/>
 	where	deptno=#{ deptno } and empno = #{ empno } <!-- DTO -->
 </select>
<!--	like
		%는 PreparedStatement의 bind변수와 함께 사용되면 인식하지 못한다.
		동에 해당하는 우편번호, 시도, 구군, 동, 번지 검색
		-->
<resultMap type="ZIPDOMAIN" id="zipResult">
<result column="zipcode" property="zipcode"/>
<result column="sido" property="sido"/>
<result column="GUGUN" property="gugun"/>
<result column="DONG" property="dong"/>
<result column="BUNJI" property="bunji"/>
</resultMap>
<select id="like" parameterType="String" resultMap="zipResult">
select zipcode, sido, gugun, dong, bunji
from zipcode
where dong like #{ dong }||'%'
</select>	

<!--	< 작다	
		연봉을 입력받아 연봉보다 적게 받는 사원의 사원명, 연봉, 보너스, 입사일을 검색
		특수문자 : &lt; CData Section ( 문자열 데이터 영역 <![CDATA[ 문제발생문자열 ]]>)
		-->	
<!-- <select id="lessThan" parameterType="int" resultType="empDomain">
select	ename, sal, comm, hiredate
from	emp
where	sal &lt; #{ sal }
</select> -->
<select id="lessThan" parameterType="int" resultType="empDomain">
<include refid="empCommon"/>
	<![CDATA[
where	sal < #{ sal }
	]]>
</select>


<!--	> 크다	
		연봉을 입력받아 연봉보다 많이 받는 사원의 사원명, 연봉, 보너스, 입사일을 검색
		크다는 에러가 안 남. 특수문자 쓸거면 &gt;써도 되고 CData Section써도 되긴 함.
-->	
<!-- <select id="greaterThan" parameterType="int" resultType="empDomain">
<include refid="empCommon"/>
where	sal > #{ sal }
</select> -->
<!-- <select id="greaterThan" parameterType="int" resultType="empDomain">
<include refid="empCommon"/>
where	sal &gt; #{ sal }
</select> -->
<select id="greaterThan" parameterType="int" resultType="empDomain">
<include refid="empCommon"/>
<![CDATA[
where	sal > #{ sal }
]]>
</select>

<!--	subquery	
		사원 테이블에서 가장 마지막에 입사한 사원보다 먼저 입사한 사원부터 
		10명의 사원정보를 검색. 검색컬럼은 사원번호, 사원명, 연봉, 입사일을 검색.
-->	
<select id="subquery" resultType="eaDomain">
select *
from(select EMPNO, ENAME, SAL, HIREDATE, ROWNUM AS DAYRANK
from(select EMPNO, ENAME, SAL, HIREDATE
from emp
order by hiredate desc))
where DAYRANK between	2 and 11;
</select>
<!--	union	-->	
<!--	join	-->	
<!--	subquery&join	-->	
<!--	$의 사용	-->	
<!--	dynamic query : if	-->	
<!--	dynamic query : choose	-->	
<!--	dynamic query : set	-->	
<!--	PL/SQL insert, update, delete, cursor	-->	
  
</mapper>